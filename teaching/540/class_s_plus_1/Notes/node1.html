<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<!--Converted with LaTeX2HTML 96.1 (Feb 5, 1996) by Nikos Drakos (nikos@cbl.leeds.ac.uk), CBLU, University of Leeds -->
<HTML>
<HEAD>
<TITLE>Review of QR algorithm</TITLE>
<META NAME="description" CONTENT="Review of QR algorithm">
<META NAME="keywords" CONTENT="class05">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<LINK REL=STYLESHEET HREF="class05.css">
</HEAD>
<BODY TEXT = "#000000" bgcolor="#FFFFFF" alink="#CC0000" vlink="#0000CC" LANG="EN">
<FONT  color="0000000" FACE="Arial,Helvetica,Sans Serif">
<H1><A NAME="SECTION00010000000000000000">Review of QR algorithm</A></H1>
<P>
Here is  a worked example  to illustrate the use of the
QR decomposition in solving a least squares equation.
<P>
For an  <IMG WIDTH=37 HEIGHT=17 ALIGN=MIDDLE ALT="tex2html_wrap_inline85" SRC="img1.gif"  >  matrix <I>X</I>, we want to find an orthogonal (length
preserving) matrix Q
( <IMG WIDTH=38 HEIGHT=14 ALIGN=MIDDLE ALT="tex2html_wrap_inline89" SRC="img2.gif"  > ) such that  <IMG WIDTH=71 HEIGHT=28 ALIGN=MIDDLE ALT="tex2html_wrap_inline91" SRC="img3.gif"  > , where <I>R</I> is a block upper triangular 
matrix.
<P>
Take 
<P> <IMG WIDTH=309 HEIGHT=77 ALIGN=BOTTOM ALT="displaymath95" SRC="img4.gif"  > <P>
then if <I>Q</I> is such that 
<P> <IMG WIDTH=417 HEIGHT=77 ALIGN=BOTTOM ALT="displaymath99" SRC="img5.gif"  > <P>
you can verify that  
<P> <IMG WIDTH=358 HEIGHT=77 ALIGN=BOTTOM ALT="displaymath101" SRC="img6.gif"  > <P>
which is block upper triangular as required.
<P>
To solve the least squares equation
<P> <IMG WIDTH=307 HEIGHT=19 ALIGN=BOTTOM ALT="displaymath103" SRC="img7.gif"  > <P>
we can equivalently solve  
<P> <IMG WIDTH=319 HEIGHT=19 ALIGN=BOTTOM ALT="displaymath105" SRC="img8.gif"  > <P>
Take for example
<P> <IMG WIDTH=296 HEIGHT=77 ALIGN=BOTTOM ALT="displaymath107" SRC="img9.gif"  > <P>
then
<P> <IMG WIDTH=326 HEIGHT=19 ALIGN=BOTTOM ALT="displaymath109" SRC="img10.gif"  > <P>
<P> <IMG WIDTH=550 HEIGHT=81 ALIGN=BOTTOM ALT="displaymath111" SRC="img11.gif"  > <P>
<P>
<P> <IMG WIDTH=414 HEIGHT=81 ALIGN=BOTTOM ALT="displaymath113" SRC="img12.gif"  > <P>
<P>
<P> <IMG WIDTH=472 HEIGHT=43 ALIGN=BOTTOM ALT="displaymath115" SRC="img13.gif"  > <P>
<P>
So  <IMG WIDTH=179 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline117" SRC="img14.gif"  >  and  <IMG WIDTH=74 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline119" SRC="img15.gif"  > .
The residual is of length  <IMG WIDTH=187 HEIGHT=28 ALIGN=MIDDLE ALT="tex2html_wrap_inline121" SRC="img16.gif"  > , so that the
RMSE =  <IMG WIDTH=132 HEIGHT=31 ALIGN=MIDDLE ALT="tex2html_wrap_inline123" SRC="img17.gif"  > 
<P>
Orthogonal matrix have the propery that  <IMG WIDTH=125 HEIGHT=28 ALIGN=MIDDLE ALT="tex2html_wrap_inline125" SRC="img18.gif"  > , so that
 <IMG WIDTH=71 HEIGHT=28 ALIGN=MIDDLE ALT="tex2html_wrap_inline91" SRC="img3.gif"  >  is equivalent to  <IMG WIDTH=63 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline129" SRC="img19.gif"  > , which is the way one usually
sees the QR decomposition.
<P>
To summarize, the objective is to decompose a matrix <I>X</I> as  <IMG WIDTH=63 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline129" SRC="img19.gif"  >  where
<I>X</I> is  <IMG WIDTH=37 HEIGHT=17 ALIGN=MIDDLE ALT="tex2html_wrap_inline85" SRC="img1.gif"  > , Q is  <IMG WIDTH=37 HEIGHT=17 ALIGN=MIDDLE ALT="tex2html_wrap_inline85" SRC="img1.gif"  >  and <I>R</I> is  <IMG WIDTH=36 HEIGHT=17 ALIGN=MIDDLE ALT="tex2html_wrap_inline143" SRC="img20.gif"  >  upper 
triangular, with <I>Q</I> orthogonal.
<P>
The S-Plus code to produce these matrices is availble as <TT>qr.q</TT>.
<P>
<HR><A NAME="tex2html16" HREF="node2.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="http://www-stat.wharton.upenn.edu/~waterman/icons/next_motif.gif"></A> <A NAME="tex2html14" HREF="class05.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="http://www-stat.wharton.upenn.edu/~waterman/icons/up_motif.gif"></A> <A NAME="tex2html8" HREF="class05.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="http://www-stat.wharton.upenn.edu/~waterman/icons/previous_motif.gif"></A>   <BR>
<B> Next:</B> <A NAME="tex2html17" HREF="node2.html">Normal equations for linear </A>
<B>Up:</B> <A NAME="tex2html15" HREF="class05.html">Class 5 Stat 540 </A>
<B> Previous:</B> <A NAME="tex2html9" HREF="class05.html">Class 5 Stat 540 </A>
<P><ADDRESS>
<I>Richard Waterman <BR>
Fri Feb 12 06:43:38 EST 1999</I>
</ADDRESS>
</FONT>
</BODY>
</HTML>
