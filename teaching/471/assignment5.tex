\documentclass[12pt]{extarticle}
\usepackage{hyperref}
\usepackage{enumerate}
\usepackage[usenames]{color}\definecolor{mypurple}{rgb}{.6,.0,.5}\newcommand{\note}[1]{\noindent{\textcolor{mypurple}{\{{\bf note:} \em #1\}}}}
\newcommand{\tech}[1]{\noindent{\textcolor{red}{\{{\bf technical note:} \em #1\}}}}

\renewcommand{\baselinestretch}{1.25}


\begin{document}
\setcounter{section}{4}

\section{Assignment 5: Paranoia}


(\href{assignment5.pdf}{pdf version}) 

You only have to do ``Day at the races'' (problem 1 below).  If you
want to do some of the other ones for fun, I'll be happy to walk
through your answers with you to see if you got them.  So, treat them
as educational / bonus material.

\subsection{Day at the races}
 One complaint about why the theorem I gave in class is that
the log is a too crude summary of wealth.  So if we had to work with
real money, the proof would not work.  Let's show that theory wrong.

In this story, we will assume you have two friends who will help you
pick ponies at a race track.  Now since gambling is illegal, we will
have your maximum amount you can win be a single penny.  To avoid all
issues of wealth, we won't worry about stakes and odds and all that,
just how much you win on each round.  So your problem is:

\begin{itemize}
\item Before each race is run, decide who you want to bet for you,
 friend A or friend B.  Call this $w_t$.  (Of course you can be
 wishywashy and bet a fraction with each as long as it adds up to
 exactly one.)
\item When the race $t$ is run, friend A will win $a_t$ pennies, and
friend $B$ will win $b_t$ pennies.
\item You collect $c_t = w_t a_t + (1-w_t) b_t$.
\end{itemize}

Your goal is to have your average winnings be about the same as the
better of the two average winnings of your two friends.  In other words:
\begin{displaymath}
\frac{\sum_{t=1}^T c_t}{T} \approx \max(\frac{\sum_{t=1}^T a_t}{T},\frac{\sum_{t=1}^T b_t}{T})
\end{displaymath}
So, no tricks this time.  No compounding.  No logs.  Just real
money.  Ok, let's figure out how to do this.
\begin{enumerate}
\item If you bet with your friend who has currently won the most, show
that there is a sequence for which you aren't close to winning as much
as your better friend wins.
\item If you always hedge your bets and put 1/2 with each, show that
there is a sequence for which you aren't close to winning as much
as your better friend wins.
\item You hire an financal accountant (they are cheap now that
 wallstreet has gone broke) to help you keep track of your pennies.
  Unfortunately, he doesn't really read the problem description very
 well and so thinks the problem uses compounding.

 He defines $A_t = 1 + a_t$ and has everone start out with one dollar.
  Hence each round $A_t = 1$ or $A_t = 1.01$ depending on whether
 friend A wins nothing or friend A wins a penny.  He then computes the
 log growth rate of this compound series.  So he is optimizing
$\log(A_t)$ whereas we actually want to optimize $a_t$.  To see that
this is about the same thing, make a plot of $\log(A_t)$ vs $a_t$ for
$a_t$ between zero and .01.  What is the farthest these two are from
each other?\footnote{For those who have had calculus in the past year
or two show that $\log \prod A_t \approx \sum a_t$.  You can get this
from our good friend Taylor: $\log(1+\epsilon) \approx 1 +
\epsilon$.  For an exact bound, you
can use that $|\log(1+\epsilon) - \epsilon| \le \epsilon^2$ if
$\epsilon < .1$.}
\end{enumerate}

We can now put this all together: Your financial accountant then
 suggest you use the usual combination scheme for compound growth.
  Namely, $w_t = A_t/(A_t+B_t)$.  Clearly this is a legal investment
 scheme, but does it have good horse race properties?  Define $C_t = 1 +
 c_t$.  By the graph you made we see that $\log \prod C_t \approx \sum c_t$.
 From the finance argument given in class
\begin{displaymath}
\frac{\log \prod C_t}{T} \approx \max(
\frac{\log \prod A_t}{T}
\frac{\log \prod B_t}{T})
\end{displaymath}
and from your graph we see $\frac{\log \prod C_t}{T} \approx
\frac{\sum_{t=1}^T c_t}{T}$ and likewise for $a$ and $b$.  Putting these
all together we see that the average combination is close to the best
combination.  

\end{enumerate}


\subsection{Three friends (for fun)}

 Suppose you have three friends, creatively called $A$, $B$ and
$C$.  Prove that if you give each of them 1/3 of a dollar and let it
ride, that your average return will be approximately as high as the
best of these three.


\subsection{Loss functions (for fun)}
 For each of the following loss function, say what probability
you would announce if you believe the true probability was .5 and
if the true probability were .9.
\begin{enumerate}
\item loss$(p,X) = I_{p>.8}X$
\item loss$(p,X) = 3p(X -.6)$
\item loss$(p,X) = (X - p)^4$ (hint: compute the expectation and take
a derivative)
\item loss$(p,X) = (X - p)^2 - \left(X \log p + (1-X) \log(1-p)\right)$.
\end{enumerate}
Which of the above are proper scoring rules?




\subsection{Calibration (for fun)}
 Consider the following three forecasting rules,
\begin{eqnarray*}
\overline{X}_t & = & \sum_{i=1}^{t-1} \frac{X_i}{t-1}\\
{\cal s}_t & = & 1/3 + X_{t-1}/3 \\
{\cal E}_t & = & .9 {\cal E}_{t-1} + .1 X_{t-1}
\end{eqnarray*}
The first one is just the average of all the previous days.  The
 second {\em switches} back and forth based on what the previous day
 looked like.  And the third is called an {\em exponential smooth} of
the previous 10 days.  Notice, none of them have a clue as to what to
forecast on the first day.  So just set them to something like .5
until they are up and running.
\begin{enumerate}
\item First make a simple simulation of weather, say IID 50/50, call
it {\bf RAIN}.  Use say, 1000 observations.
\item Now make a column in JMP (or an R function) which will represent
each of these forecasts.
\item Compute the calibration curve for each of these three forecasts.
  (You can do this by simply plotting {\bf RAIN} vs each of the three
 forecasts and then doing your favorite smooth or polynomial
 regression.)  This is called the calibration curve.  We can call it
 $C(f)$.
\item You can pretty much see what is going on by looking at the
picture.  But to get a number that you can apply to these forecasts,
proceed as follows:
\begin{enumerate}
\item save the smooth generate in the previous section.
\item compute the difference between the smooth and the forecast.
\item Now square this difference and compute the average.
\end{enumerate}
You have now computed;
\begin{displaymath}
\hbox{calibration score} = \sum_{t=1}^T (C(\overline{X}_t) - \overline{X}_t)^2/T
\end{displaymath}
If this number is small, it says the forecast $\overline{X}_t$ is
close to calibrated for this data.  If it is large, it isn't close to
calibrated. 
\item Now the fun begins.  Generate some new data for {\bf RAIN}.
Think evil!  Try to make the calibration plots as bad as possible for
each of the three forecasts.  Some ideas to try:
\begin{itemize}
\item IID with different probabilities
\item $0,1,0,1,0,1,0,1,0,1,\ldots$
\item $0,0,0,0,0,0,0,\ldots,1,1,1,1,1,\ldots$ (say 500 of each)
\item For those in my 433 class, maybe a Markov chain might be
nice. Something like:
\begin{displaymath}
\left[\begin{array}{cc}.9 &.1\\.2 & .8
\end{array}
\right]
\end{displaymath}
\item Have the probability of rain change over time.  For example,
have the probability of rain be equal to the forecast made by ONE of
the three forecasting rules and see if that messes up another
forecasting rule.
\item Any other ideas?
\end{itemize}
\end{enumerate}

\end{document}
